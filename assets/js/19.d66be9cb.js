(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{399:function(s,e,t){s.exports=t.p+"assets/img/triton-grafana-dashboard.dee5800d.png"},400:function(s,e,t){s.exports=t.p+"assets/img/triton-inference-testresult.b934554e.png"},515:function(s,e,t){"use strict";t.r(e);var r=t(40),n=Object(r.a)({},(function(){var s=this,e=s.$createElement,r=s._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[r("h1",{attrs:{id:"triton-inference-server"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#triton-inference-server"}},[s._v("#")]),s._v(" Triton Inference Server")]),s._v(" "),r("h2",{attrs:{id:"introduction"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#introduction"}},[s._v("#")]),s._v(" Introduction")]),s._v(" "),r("p",[s._v("Triton Inference Server는 CPU와 GPU 모두에 최적화된 Cloud / Edge Inference Solution 을 제공한다. Triton은 HTTP/REST 및 GRPC 프로토콜을 지원하여 원격 클라이언트가 서버에서 관리하는 모든 모델에 대한 Inferencing 을 요청할 수 있도록 한다")]),s._v(" "),r("ul",[r("li",[s._v("Features\n"),r("ul",[r("li",[s._v("Multiple deep-learning framework 지원")]),s._v(" "),r("li",[s._v("Concurrent Model Execution")]),s._v(" "),r("li",[s._v("Dynamic Batching")]),s._v(" "),r("li",[r("em",[r("b",[r("u",[s._v("KFServing Protocol")])])])])])])]),s._v(" "),r("p",[s._v("위와 같은 다양한 기능이 제공되며,"),r("br"),s._v("\nTriton 기능 점검이 아닌, Kubernetes 환경에서의 Triton Inference Server 구성 및 테스트를 진행함."),r("br"),s._v("\nModel Serving 관련 KFServing 구성 및 InferenceService 테스트를 진행함.")]),s._v(" "),r("h2",{attrs:{id:"architecture"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#architecture"}},[s._v("#")]),s._v(" Architecture")]),s._v(" "),r("p",[s._v("Kubernetes 환경에서는 deployment 를 통한 pod 으로 단순하게 구성되지만, 내부적으로는 아래와 같은 구조를 갖고 있다.")]),s._v(" "),r("ul",[r("li",[r("p",[s._v("Model Repository")]),s._v(" "),r("ul",[r("li",[s._v("Triton Inferencing 에 사용할 수 있는 파일 시스템 기반의 저장소이며, Volume Mount 및 Object Storage 활용 가능.")]),s._v(" "),r("li",[s._v("Triton Server 실행 시, --model-store option 으로 directory 를 지정.")])])]),s._v(" "),r("li",[r("p",[s._v("Client Request Scheduling / Routing")]),s._v(" "),r("ul",[r("li",[s._v("Inferencing 요청은 HTTP/REST, GRPC 호출 혹은, C API 직접 호출을 통하여 가능.")]),s._v(" "),r("li",[s._v("내부적으로 Model 별 Scheduler 로 Routing.")]),s._v(" "),r("li",[s._v("Model Repository 에서 load 한 model 각각의 스케줄링 및 처리 알고리즘이 구현됨.")])])]),s._v(" "),r("li",[r("p",[s._v("Framework Backends")]),s._v(" "),r("ul",[r("li",[s._v("Inferencing 요청 Model 유형에 해당하는 Framework Backend 로 전달됨.")]),s._v(" "),r("li",[s._v("Inference 수행 및 Output Return.")])])]),s._v(" "),r("li",[r("p",[s._v("Monitoring")]),s._v(" "),r("ul",[r("li",[s._v("Kubernetes 에 통합 가능한 Readiness, Liveness, 처리량 및 대기 시간 등의 metric 활용 가능")])])]),s._v(" "),r("li",[r("p",[s._v("Triton High-Level Architecture"),r("br"),s._v(" "),r("img",{attrs:{src:"https://github.com/triton-inference-server/server/raw/main/docs/images/arch.jpg",title:"triton-arch",alt:"triton-arch"}})])])]),s._v(" "),r("blockquote",[r("p",[s._v("Triton Inference Server Github Repository"),r("br"),s._v(" "),r("a",{attrs:{href:"https://github.com/triton-inference-server/server",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/triton-inference-server/server"),r("OutboundLink")],1),r("br"),s._v("\nTriton Inference Server Architecture 참조"),r("br"),s._v(" "),r("a",{attrs:{href:"https://github.com/triton-inference-server/server/blob/main/docs/architecture.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/triton-inference-server/server/blob/main/docs/architecture.md"),r("OutboundLink")],1)])]),s._v(" "),r("h2",{attrs:{id:"kubernetes-deploy"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-deploy"}},[s._v("#")]),s._v(" Kubernetes Deploy")]),s._v(" "),r("p",[s._v("AWS EKS 환경에 deploy 하기 위한 Helm Chart 를 제공. 공식 가이드는 tiller 구성을 포함하고 있으나, 해당 구성 없이 helm v3 활용하여 설치하였음."),r("br"),s._v("\n기본적으로 deployment 로 pod 이 생성되며, replicas 관리를 통해서 HA 구성을 하도록 가이드하고 있음.")]),s._v(" "),r("ul",[r("li",[s._v("작업 순서\n"),r("ol",[r("li",[s._v("Amazon EKS Cluster 생성")]),s._v(" "),r("li",[s._v("Amazon S3 Model Repository 구성")]),s._v(" "),r("li",[s._v("triton-inference-server helm chart 배포")]),s._v(" "),r("li",[s._v("Monitoring 을 위한 prometheus-operator helm chart 배포")]),s._v(" "),r("li",[s._v("triton-inference-server sdk client 구성 및 inferencing 테스트")])])])]),s._v(" "),r("blockquote",[r("p",[s._v("Triton Inference Server AWS Deploy Guide"),r("br"),s._v(" "),r("a",{attrs:{href:"https://github.com/htdp1/mlops-k8s/tree/main/triton-inference-server/deploy/aws",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/htdp1/mlops-k8s/tree/main/triton-inference-server/deploy/aws"),r("OutboundLink")],1),r("br"),s._v("\nTriton Quick Start Guide"),r("br"),s._v(" "),r("a",{attrs:{href:"https://github.com/triton-inference-server/server/blob/main/docs/quickstart.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/triton-inference-server/server/blob/main/docs/quickstart.md"),r("OutboundLink")],1)])]),s._v(" "),r("h3",{attrs:{id:"tritonserver-helm-chart-배포"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#tritonserver-helm-chart-배포"}},[s._v("#")]),s._v(" tritonserver helm chart 배포")]),s._v(" "),r("ul",[r("li",[s._v("S3 에 Access 하기 위한 AWS Access Key 를 values.yaml 에 mapping")]),s._v(" "),r("li",[s._v("imageName, modelRepositoryPath, cpu 등 수정")]),s._v(" "),r("li",[s._v("LoadBalancer 로 Service 생성하여, Amazon Classic Load Balancer 생성")])]),s._v(" "),r("div",{staticClass:"language-yaml line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-yaml"}},[r("code",[r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("replicaCount")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("service")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" LoadBalancer\n\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imageName")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nvcr.io/nvidia/tritonserver"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("21.04"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("py3\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pullPolicy")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IfNotPresent\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("modelRepositoryPath")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" s3"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//htdp1"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("triton"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("inference"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("repository/model_repository\n  "),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# numGpus: 1")]),s._v("\n  "),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("numCpus")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),r("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("secret")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n  "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br")])]),r("ul",[r("li",[s._v("result")])]),s._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[s._v("$ kubectl get all -n triton\nNAME                                                 READY   STATUS    RESTARTS   AGE\npod/htdp1-triton-inference-server-6b969d654c-n6xkn   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     Running   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("          39m\n\nNAME                                            TYPE           CLUSTER-IP       EXTERNAL-IP    PORT"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                         AGE\nservice/htdp1-triton-inference-server           LoadBalancer   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".209.89    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("External-IP"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":31422/TCP,8001:31024/TCP,8002:30129/TCP   3h24m\nservice/htdp1-triton-inference-server-metrics   ClusterIP      "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.100")]),s._v(".179.240   "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("none"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("          "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("/TCP   3h24m\n\nNAME                                            READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/htdp1-triton-inference-server   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("/1     "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("            "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("           3h24m\n\nNAME                                                       DESIRED   CURRENT   READY   AGE\nreplicaset.apps/htdp1-triton-inference-server-6b969d654c   "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("         "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       3h24m\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br")])]),r("ul",[r("li",[s._v("logs")])]),s._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[s._v("\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Framework Backend")]),s._v("\nI0526 03:39:25.498911 "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" server.cc:543"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n+-------------+-----------------------------------------------------------------+--------+\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Backend     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Path                                                            "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Config "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------+-----------------------------------------------------------------+--------+\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tensorrt    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("built-in"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("                                                      "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" pytorch     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /opt/tritonserver/backends/pytorch/libtriton_pytorch.so         "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tensorflow  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /opt/tritonserver/backends/tensorflow1/libtriton_tensorflow1.so "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" onnxruntime "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /opt/tritonserver/backends/onnxruntime/libtriton_onnxruntime.so "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" openvino    "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /opt/tritonserver/backends/openvino/libtriton_openvino.so       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("     "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+-------------+-----------------------------------------------------------------+--------+\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Model Repository 에 있는 Model Loading")]),s._v("\nI0526 03:39:25.498991 "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" server.cc:586"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n+----------------------+---------+--------+\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Model                "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Version "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Status "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------------+---------+--------+\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" densenet_onnx        "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" inception_graphdef   "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" simple               "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" simple_dyna_sequence "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" simple_identity      "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" simple_int8          "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" simple_sequence      "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" simple_string        "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("       "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" READY  "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----------------------+---------+--------+\n\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 기본 Service Port (HTTP, GRPC, Metric)")]),s._v("\nI0526 03:39:25.500218 "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" grpc_server.cc:4028"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Started GRPCInferenceService at "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8001\nI0526 03:39:25.500467 "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" http_server.cc:2761"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Started HTTPService at "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8000\nI0526 03:39:25.541702 "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" http_server.cc:2780"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Started Metrics Service at "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8002\n\n"),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br"),r("span",{staticClass:"line-number"},[s._v("16")]),r("br"),r("span",{staticClass:"line-number"},[s._v("17")]),r("br"),r("span",{staticClass:"line-number"},[s._v("18")]),r("br"),r("span",{staticClass:"line-number"},[s._v("19")]),r("br"),r("span",{staticClass:"line-number"},[s._v("20")]),r("br"),r("span",{staticClass:"line-number"},[s._v("21")]),r("br"),r("span",{staticClass:"line-number"},[s._v("22")]),r("br"),r("span",{staticClass:"line-number"},[s._v("23")]),r("br"),r("span",{staticClass:"line-number"},[s._v("24")]),r("br"),r("span",{staticClass:"line-number"},[s._v("25")]),r("br"),r("span",{staticClass:"line-number"},[s._v("26")]),r("br"),r("span",{staticClass:"line-number"},[s._v("27")]),r("br"),r("span",{staticClass:"line-number"},[s._v("28")]),r("br"),r("span",{staticClass:"line-number"},[s._v("29")]),r("br"),r("span",{staticClass:"line-number"},[s._v("30")]),r("br"),r("span",{staticClass:"line-number"},[s._v("31")]),r("br"),r("span",{staticClass:"line-number"},[s._v("32")]),r("br"),r("span",{staticClass:"line-number"},[s._v("33")]),r("br"),r("span",{staticClass:"line-number"},[s._v("34")]),r("br"),r("span",{staticClass:"line-number"},[s._v("35")]),r("br"),r("span",{staticClass:"line-number"},[s._v("36")]),r("br"),r("span",{staticClass:"line-number"},[s._v("37")]),r("br")])]),r("h3",{attrs:{id:"inference-request-monitoring"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#inference-request-monitoring"}},[s._v("#")]),s._v(" Inference Request Monitoring")]),s._v(" "),r("p",[s._v("stable/prometheus 를 배포하여, inference request Monitoring."),r("br"),s._v("\n배포 시, "),r("em",[s._v("prometheus.prometheusSpec.serviceMonitorSelectorNilUsesHelmValues=false")]),s._v(" 지정해야, prometheus 가 inferece server metric 을 추적할 수 있다.")]),s._v(" "),r("ul",[r("li",[s._v("triton server 에서 제공하는 Grafana Dashboard\n"),r("ul",[r("li",[s._v("Inference Request 에 대한 처리 metric 이 모델마다 각각 추적됨. (repository model 8개)")]),s._v(" "),r("li",[s._v("Scheduling 을 위한 Queue 도 각각 생성됨.")])])])]),s._v(" "),r("p",[r("img",{attrs:{src:t(399),alt:""}})]),s._v(" "),r("blockquote",[r("p",[s._v("grafana dashboard.json 참조"),r("br"),s._v(" "),r("a",{attrs:{href:"https://github.com/triton-inference-server/server/blob/main/deploy/aws/dashboard.json",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/triton-inference-server/server/blob/main/deploy/aws/dashboard.json"),r("OutboundLink")],1)])]),s._v(" "),r("h3",{attrs:{id:"sdk-client-test"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#sdk-client-test"}},[s._v("#")]),s._v(" SDK Client Test")]),s._v(" "),r("p",[s._v("Triton Inference Server 에 경우, 특정한 directory 구조 및 file 을 갖고 있어야 model 을 실행할 수 있다. sample 로 제공되는 model 을 활용하여, Amazon S3 에 Model Repository 를 구성하고, EKS 에 배포된 triton-inference-server 에 sample model inference 요청 테스트를 한 결과이다.")]),s._v(" "),r("blockquote",[r("p",[s._v("triton sample model 참조"),r("br"),s._v(" "),r("a",{attrs:{href:"https://github.com/triton-inference-server/server/tree/main/docs/examples/model_repository",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/triton-inference-server/server/tree/main/docs/examples/model_repository"),r("OutboundLink")],1)])]),s._v(" "),r("ul",[r("li",[s._v("triton-inference-server SDK Docker container 실행")])]),s._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[s._v("docker pull nvcr.io/nvidia/tritonserver:21.04-py3-sdk\ndocker run -it --rm --net"),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("host nvcr.io/nvidia/tritonserver:21.04-py3-sdk\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br")])]),r("ul",[r("li",[s._v("SDK container 에 접속하여, image_client 를 실행하여 http request test 한 결과")])]),s._v(" "),r("div",{staticClass:"language-sh line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-sh"}},[r("code",[r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# densenet_onnx 실행")]),s._v("\nroot@docker-desktop:/workspace"),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /workspace/install/bin/image_client -m densenet_onnx -c 3 -s INCEPTION -u <External-IP>:8000 /workspace/images/mug.jpg")]),s._v("\nRequest "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", batch size "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nImage "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/workspace/images/mug.jpg'")]),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("15.349564")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" COFFEE MUG\n    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("13.227464")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("968")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CUP\n    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.424892")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("505")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" COFFEEPOT\n\n"),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# inception_graphdef 실행")]),s._v("\nroot@docker-desktop:/workspace"),r("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /workspace/install/bin/image_client -m inception_graphdef -c 3 -s INCEPTION -u <External-IP>:8000 /workspace/images/mug.jpg")]),s._v("\nRequest "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", batch size "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nImage "),r("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/workspace/images/mug.jpg'")]),r("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v("\n    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.754047")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("505")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" COFFEE MUG\n    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.157066")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("969")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" CUP\n    "),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.002878")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),r("span",{pre:!0,attrs:{class:"token number"}},[s._v("968")]),r("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),r("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ESPRESSO\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br")])]),r("ul",[r("li",[s._v("각 model 이 처리된 내역 Monitoring")])]),s._v(" "),r("p",[r("img",{attrs:{src:t(400),alt:""}})])])}),[],!1,null,null,null);e.default=n.exports}}]);